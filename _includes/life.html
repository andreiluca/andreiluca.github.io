<script>
function timeAgo(time){
    var units = [
    { name: "second", limit: 60, in_seconds: 1 },
    { name: "minute", limit: 3600, in_seconds: 60 },
    { name: "hour", limit: 86400, in_seconds: 3600 },
    { name: "day", limit: 604800, in_seconds: 86400 },
    { name: "week", limit: 2629743, in_seconds: 604800 },
    { name: "month", limit: 31556926, in_seconds: 2629743 },
    { name: "year", limit: null, in_seconds: 31556926 }
    ];
    var diff = (new Date() - new Date(time*1000)) / 1000;
    if (diff < 5) return "now";
    var i = 0;
    var unit = null;

    while ((unit = units[i++]) !== null) {
      if (diff < unit.limit || !unit.limit){
        diff = Math.floor(diff / unit.in_seconds);
        return diff + " " + unit.name + (diff>1 ? "s" : "") + " ago";
      }
    }
}

// GET DATA FROM TRACK.ANDREILUCA.COM

var al = function(data) {
  //var moves = "I've made " + data.moves.steps.toLocaleString() + " steps today, burned " + data.moves.calories.toLocaleString() + " calories, walked " + data.moves.distance.toLocaleString() + " meters.";

  var moves = "I've made " + data.googlefit.steps.toLocaleString() + " awesome steps today!";
  //if(data.moves.steps > 1000)
    document.getElementById('track-moves').innerHTML = moves;

  var health = "My heart beat rate is " + data.health.heartRate.bpm + " bpm measured almost " + timeAgo(data.health.heartRate.timestamp) + ".";
    document.getElementById('track-health').innerHTML = health;

    //age = setInterval(function() { al_age(data.health.age.date); }, 100);


    //if(data.moves.sleep == true)
      //  document.getElementById('track-sleep').innerHTML = 'ðŸ’¤';

 document.getElementById("track-age").innerHTML = data.health.age.days.toLocaleString() + ' days spent on earth. Getting old!';

};

var alt = document.createElement('script'); alt.type = 'text/javascript'; alt.async = true;
alt.src = "http://track.andreiluca.com/api/?callback=al";
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(alt, s);

// CALCULATE AGE

function al_age(bday) {
    var date = new Date(bday);
    var now = new Date();
    var duration = now - date;
    var years = duration / 31556900000;
    var majorMinor = years.toFixed(9).toString().split('.');
    document.getElementById("track-age").innerHTML = majorMinor[0] + ',' + majorMinor[1];
}
</script>